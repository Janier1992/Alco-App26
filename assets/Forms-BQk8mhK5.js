import{j as e}from"./vendor-ui-Csmkvd-_.js";import{r as l,u as Be}from"./vendor-react-B11IQRCK.js";import{G as Ee}from"./vendor-core-L0lX3Z62.js";import{B as Ve}from"./Breadcrumbs-D1gceSdN.js";import{a as Oe,R as q,b as We,c as Se,L as pe,P as Re,d as ve,e as H,f as Je,g as ke,h as je,A as He,D as Ye,E as qe,i as Ke,O as Qe,j as Xe,k as Ze,l as ye,m as Ie,n as Ce,o as et}from"./index-CRB8BTUJ.js";import{s as F}from"./insforgeClient-BTlHhBMi.js";import{B as tt}from"./BulkUploadButton-COujV333.js";const at=({onTranscription:m,className:U,smartMode:A=!1})=>{const{addNotification:v}=Oe(),[I,$]=l.useState(!1),[O,g]=l.useState(!1),f=l.useRef(null),T=l.useRef([]),_=async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return v({type:"error",title:"NAVEGADOR NO COMPATIBLE",message:"Su navegador no soporta captura de audio."});T.current=[];try{const x=await navigator.mediaDevices.getUserMedia({audio:!0}),u=new MediaRecorder(x);f.current=u,u.ondataavailable=h=>{h.data.size>0&&T.current.push(h.data)},u.onstop=async()=>{const h=new Blob(T.current,{type:"audio/webm"});await n(h),x.getTracks().forEach(G=>G.stop())},u.start(),$(!0),v({type:"info",title:"ESCUCHANDO",message:"Dictado técnico en curso..."})}catch(x){console.error("Error al acceder al micrófono:",x);let u="Ocurrió un error al intentar acceder al micrófono.";x.name==="NotFoundError"||x.name==="DevicesNotFoundError"||x.message?.includes("device not found")?u="No se encontró ningún micrófono conectado o habilitado en su dispositivo.":(x.name==="NotAllowedError"||x.name==="PermissionDeniedError")&&(u="Debe permitir el uso del micrófono en su navegador para usar esta función."),v({type:"error",title:"FALLO DE HARDWARE",message:u})}},M=()=>{f.current&&I&&(f.current.stop(),$(!1))},n=async x=>{g(!0);try{const u=new FileReader;u.readAsDataURL(x),u.onloadend=async()=>{const h=u.result.split(",")[1],xe=new Ee("AIzaSyAao48NBXbU0Kqwp8vJJl7J3I4vU4sRKO4").getGenerativeModel({model:"gemini-1.5-flash"}),K=A?"Actúa como un asistente de llenado de formularios de calidad. Extrae los datos técnicos del audio y devuélvelos en formato JSON estricto (sin markdown) con las siguientes claves si se mencionan: 'op', 'areaProceso', 'planoOpc', 'cantTotal' (número), 'defecto', 'estado', 'observacion'. Si no hay datos claros, devuelve un JSON con la clave 'observacion' que contenga el texto transcrito.":"Actúa como transcriptor experto en manufactura. Transcribe este audio exactamente. Si hay errores gramaticales o de dicción, corrígelos para que suenen técnicos y profesionales. Devuelve solo el texto final.",D=(await xe.generateContent([K,{inlineData:{mimeType:"audio/webm",data:h}}])).response.text()||"";D.trim()?(m(D),v({type:"success",title:"DICTADO PROCESADO",message:"Texto integrado en el formulario."})):v({type:"warning",title:"AUDIO NO CLARO",message:"No se detectó voz clara en el dictado."}),g(!1)}}catch(u){console.error("Error en transcripción IA:",u),v({type:"error",title:"FALLO TRANSCRIPCIÓN",message:"El motor Gemini no pudo procesar el audio."}),g(!1)}};return e.jsx("button",{type:"button",onClick:I?M:_,disabled:O,className:`flex items-center justify-center transition-all p-3 rounded-2xl ${I?"bg-rose-500 text-white animate-pulse shadow-lg shadow-rose-500/30":"bg-slate-100 dark:bg-slate-700 text-[#5d5fef] hover:bg-slate-200 dark:hover:bg-slate-600"} ${O?"opacity-50 cursor-wait":"hover:scale-110 active:scale-95"} ${U}`,title:I?"Detener Dictado":"Iniciar Dictado por Voz",children:O?e.jsx(q,{className:"animate-spin text-lg"}):e.jsx(We,{})})},Y=({label:m,options:U,value:A,onChange:v,placeholder:I,className:$})=>{const[O,g]=l.useState(!1),[f,T]=l.useState(""),_=l.useRef(null);l.useEffect(()=>{O||T(A||"")},[A,O]);const M=l.useMemo(()=>U.filter(h=>h.toLowerCase().includes((f||"").toLowerCase())),[U,f]),n=f.trim()!==""&&!U.some(h=>h.toLowerCase()===f.toLowerCase());return l.useEffect(()=>{const h=G=>{_.current&&!_.current.contains(G.target)&&g(!1)};return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[]),e.jsxs("div",{className:`relative ${$}`,ref:_,children:[e.jsx("label",{className:"text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1.5 block ml-1",children:m}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",className:"w-full p-3 bg-slate-50 dark:bg-[#0b0b14] border border-slate-200 dark:border-white/5 rounded-lg text-xs font-bold text-slate-900 dark:text-white focus:ring-2 focus:ring-[#5d5fef] outline-none transition-all uppercase placeholder:text-slate-400",placeholder:I||"Buscar o agregar...",value:f,onFocus:()=>g(!0),onChange:h=>{T(h.target.value),g(!0)}}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none",children:e.jsx(Ie,{})})]}),O&&e.jsx("div",{className:"absolute z-[2100] w-full mt-2 bg-white dark:bg-[#1a1a24] border border-slate-200 dark:border-white/10 rounded-2xl shadow-2xl overflow-hidden max-h-60 overflow-y-auto custom-scrollbar animate-fade-in-up",children:e.jsxs("div",{className:"p-1",children:[M.map((h,G)=>e.jsxs("button",{type:"button",onClick:()=>{v(h),T(h),g(!1)},className:`w-full text-left px-4 py-2.5 rounded-xl text-xs font-bold uppercase transition-colors flex items-center justify-between group ${A===h?"bg-sky-50 dark:bg-sky-900/20 text-sky-600":"text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-white/5"}`,children:[h,A===h&&e.jsx("i",{className:"fas fa-check text-[10px]"})]},G)),n&&e.jsxs("button",{type:"button",onClick:()=>{v(f),g(!1)},className:"w-full text-left px-4 py-3 rounded-xl bg-emerald-50 dark:bg-emerald-900/10 text-emerald-600 dark:text-emerald-400 text-xs font-black uppercase border border-dashed border-emerald-200 dark:border-emerald-800/30 hover:bg-emerald-100 transition-all flex items-center gap-2",children:[e.jsx(Re,{className:"scale-75"})," Agregar: ",f]})]})})]})},Ae={fecha:new Date().toISOString().split("T")[0],areaProceso:"",op:"",planoOpc:"",disenoReferencia:"",cantTotal:0,cantRetenida:0,estado:"Aprobado",defecto:"NINGUNO",reviso:Se[0],responsable:"",accionCorrectiva:"",observacionSugerida:"",observacion:"NA",photo:""},dt=()=>{const{addNotification:m}=Oe(),[U,A]=l.useState("none"),[v,I]=l.useState(!1),[$,O]=l.useState(!1),[g,f]=l.useState(null),[T,_]=l.useState([]);l.useEffect(()=>{M()},[]);const M=async()=>{try{const{data:t,error:s}=await F.from("external_links").select("*").order("created_at",{ascending:!1});if(s)throw s;_(t||[])}catch(t){console.error("Error fetching links:",t)}},[n,x]=l.useState(Ae),[u,h]=l.useState([]),[G,xe]=l.useState(!1),[K,W]=l.useState(null),[D,Q]=l.useState(!1),[S,X]=l.useState(new Set),[J,Te]=l.useState(""),[Z,De]=l.useState(null),[i,Le]=l.useState({key:null,direction:"asc"}),[k,ee]=l.useState(1),B=50,[d,j]=l.useState({fecha:"",op:"",areaProceso:"",planoOpc:"",disenoReferencia:"",cantTotal:"",cantRetenida:"",estado:"",defecto:"",reviso:"",responsable:"",accionCorrectiva:"",observacion:""}),[o,Pe]=l.useState({checkbox:50,fecha:120,areaProceso:150,op:100,planoOpc:100,disenoReferencia:150,cantTotal:100,cantRetenida:100,estado:120,defecto:120,reviso:150,responsable:150,accionCorrectiva:150,observacion:250,actions:100}),te=l.useRef(null),N=(t,s)=>{s.preventDefault(),s.stopPropagation();const a=o[t]||100;te.current={column:t,startX:s.clientX,startWidth:a},document.addEventListener("mousemove",he),document.addEventListener("mouseup",me)},he=t=>{if(!te.current)return;const{column:s,startX:a,startWidth:r}=te.current,c=t.clientX-a;Pe(p=>({...p,[s]:Math.max(50,r+c)}))},me=()=>{te.current=null,document.removeEventListener("mousemove",he),document.removeEventListener("mouseup",me)},w=t=>{Le(s=>({key:t,direction:s.key===t&&s.direction==="asc"?"desc":"asc"}))},R=l.useMemo(()=>{if(Z)return u.filter(s=>s.id===Z);let t=u.filter(s=>{const a=Object.entries(d).every(([c,p])=>p?String(s[c]||"").toLowerCase().includes(p.toLowerCase()):!0);if(!J)return a;const r=Object.values(s).some(c=>String(c||"").toLowerCase().includes(J.toLowerCase()));return a&&r});return i.key&&t.sort((s,a)=>{const r=s[i.key]||"",c=a[i.key]||"";return r<c?i.direction==="asc"?-1:1:r>c?i.direction==="asc"?1:-1:0}),t},[u,d,J,i,Z]),ae=l.useMemo(()=>{const t=(k-1)*B;return R.slice(t,t+B)},[R,k,B]),V=Math.ceil(R.length/B);l.useEffect(()=>{ee(1)},[J,d,Z]);const z=Be();l.useEffect(()=>{oe()},[]),l.useEffect(()=>{z.state&&(z.state.filterId&&(De(z.state.filterId),W(z.state.filterId)),z.state.editingId&&!z.state.filterId&&W(z.state.editingId))},[z.state,u]);const oe=async()=>{Q(!0);try{const{data:t,error:s}=await F.from("field_inspections").select("*").order("created_at",{ascending:!1});if(s)throw s;const a=(t||[]).map(r=>({id:r.id,fecha:r.fecha||new Date().toISOString().split("T")[0],areaProceso:r.area_proceso||"",op:r.op||"",planoOpc:r.plano_opc||"",disenoReferencia:r.diseno_referencia||"",cantTotal:r.cant_total||0,cantRetenida:r.cant_retenida||0,estado:r.estado||"Aprobado",defecto:r.defecto||"NINGUNO",reviso:r.reviso||"",responsable:r.responsable||"",accionCorrectiva:r.accion_correctiva||"",observacionSugerida:r.observacion_sugerida||"",observacion:r.observacion||"",photo:r.photo_url||""}));h(a)}catch(t){console.error(t),m({type:"error",title:"Error",message:"No se pudieron cargar las inspecciones."})}finally{Q(!1)}},Ue=async t=>{t.preventDefault();const s=t.target,a=new FormData(s);try{const{error:r}=await F.from("external_links").insert([{title:a.get("title").toUpperCase(),url:a.get("url"),description:a.get("description"),color:a.get("color")}]);if(r)throw r;M(),O(!1),m({type:"success",title:"ENLACE AGREGADO",message:"Configuración sincronizada en la nube."})}catch(r){m({type:"error",title:"ERROR",message:r.message})}},ze=async(t,s)=>{if(confirm(`¿Eliminar enlace "${s}"?`))try{const{error:a}=await F.from("external_links").delete().eq("id",t);if(a)throw a;M()}catch(a){m({type:"error",title:"ERROR",message:a.message})}},L=t=>{const{name:s,value:a}=t.target;x({...n,[s]:a})},Fe=t=>{const s=new Set;return t.split(",").map(r=>r.trim()).forEach(r=>{if(r.includes("-")){const[c,p]=r.split("-").map(b=>parseInt(b,10));if(!isNaN(c)&&!isNaN(p)&&c<=p)for(let b=c;b<=p;b++)s.add(b.toString())}else r&&s.add(r)}),Array.from(s).sort((r,c)=>{const p=parseInt(r),b=parseInt(c);return!isNaN(p)&&!isNaN(b)?p-b:r.localeCompare(c)})},[se,ue]=l.useState(!1),_e=async()=>{if(!API_KEY||API_KEY.includes("YOUR_GEMINI_API_KEY")){m({type:"error",title:"CONFIGURACIÓN FALTANTE",message:"Configure VITE_GEMINI_API_KEY en .env.local con una llave válida."});return}let t=n.photo,s="image/png";if(!t){const r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAiSURBVHgB7c6xCQAgDAVRR9A6g4u4/2QW4QPct8p1CR8zM3O3750A8iJLiSwlspTIUiJLiSwlspTIUiJLiSwlspTIUiJLiSwlspTIUiJLiSwlspTIUiJLiyx9I8sF/w49i0kAAAAASUVORK5CYII=";x(c=>({...c,photo:r})),m({type:"info",title:"MODO DEMO",message:"Se ha cargado una imagen de prueba. Procesando..."}),t=r}const a=t.split(",");a.length>1?(s=a[0].match(/:(.*?);/)?.[1]||s,t=a[1]):s="image/png",ue(!0),m({type:"info",title:"ANALIZANDO...",message:"Gemini 1.5 Flash está inspeccionando la imagen..."});try{const le=(await(await new Ee(API_KEY).getGenerativeModel({model:"gemini-1.5-flash-001"}).generateContent([`
                Analiza esta imagen de una parte industrial / perfil de aluminio. Actúa como un experto inspector de calidad.
                Responde EXCLUSIVAMENTE con un objeto JSON (sin markdown) con la siguiente estructura:
                {
                    "cantTotal": number (conteo de unidades visibles, estimado si es difícil),
                    "defecto": string (uno de: "NINGUNO", "RAYAS", "GOLPES", "DECOLORACION", "REVENTON"),
                    "observacion": string (descripción técnica breve y profesional del hallazgo en ESPAÑOL)
                }
                Si no se detecta defecto, el defecto es "NINGUNO".
                Asegúrate de que el campo "observacion" esté SIEMPRE en ESPAÑOL. Responde SIEMPRE en Español.
            `,{inlineData:{data:t,mimeType:s}}])).response).text().replace(/```json/g,"").replace(/```/g,"").trim(),P=JSON.parse(le);let ce="Aprobado",re="None",we=!1;P.defecto!=="NINGUNO"&&(["REVENTON","DECOLORACION"].includes(P.defecto)?(ce="Rechazado",re="Critical",we=!0):(ce="Aprobado (Condicionado)",re="Warning")),x(de=>({...de,cantTotal:P.cantTotal||0,defecto:P.defecto||"NINGUNO",estado:ce,alertLevel:re,isLocked:we,observacion:de.observacion==="NA"?`IA: ${P.observacion}`:`${de.observacion} 
[IA]: ${P.observacion}`})),m(re==="Critical"?{type:"error",title:"BLOQUEO DE CALIDAD",message:`Defecto CRÍTICO detectado (${P.defecto}).`}:{type:"success",title:"ANÁLISIS COMPLETADO",message:`Conteo: ${P.cantTotal} | Defecto: ${P.defecto}`})}catch(r){console.error("AI Error:",r),m({type:"error",title:"FALLO DE ANÁLISIS",message:"No se pudo procesar la imagen con IA."})}finally{ue(!1)}},be=t=>{const{id:s,...a}=t;x(a),W(s),A("general"),window.scrollTo({top:0,behavior:"smooth"})},ne=async t=>{const s=Array.isArray(t),a=s?t:[t],r=s?`¿Confirmas la eliminación permanente de ${a.length} registros seleccionados?`:"¿Eliminar este registro de inspección permanentemente?";if(confirm(r)){Q(!0);try{for(let p=0;p<a.length;p+=100){const b=a.slice(p,p+100),{error:ie}=await F.from("field_inspections").delete().in("id",b);if(ie)throw ie;h(Ne=>Ne.filter(le=>!b.includes(le.id)))}s&&X(new Set),m({type:"error",title:s?"REGISTROS ELIMINADOS":"REGISTRO ELIMINADO",message:s?`${a.length} registros han sido removidos.`:"La inspección ha sido eliminada del historial."})}catch(c){console.error(c),m({type:"error",title:"Error",message:"No se pudo completar la eliminación acelerada. Algunos registros podrían persistir."})}finally{Q(!1)}}},ge=()=>{S.size===R.length?X(new Set):X(new Set(R.map(t=>t.id)))},fe=t=>{const s=new Set(S);s.has(t)?s.delete(t):s.add(t),X(s)},Me=async t=>{const a={serial_id:`NC-AUTO-${Date.now().toString().slice(-4)}`,title:`NC AUTOMÁTICA: RECHAZO EN ${t.area_proceso}`.toUpperCase(),process:t.area_proceso,project:t.op,severity:"Mayor",description:`Hallazgo generado automáticamente por inspección rechazada. Defecto: ${t.defecto}. Observación: ${t.observacion}`,status:"Abierta",rca:{why1:"",why2:"",why3:"",why4:"",why5:"",rootCause:""}},{error:r}=await F.from("non_conformities").insert([a]);r&&console.error("Error triggering NC:",r)},Ge=async t=>{t.preventDefault();const s=a=>({fecha:a.fecha||new Date().toISOString().split("T")[0],area_proceso:(a.areaProceso||"").toUpperCase(),op:(a.op||"").toUpperCase(),plano_opc:(a.planoOpc||"").toString().toUpperCase(),diseno_referencia:(a.disenoReferencia||"").toUpperCase(),cant_total:parseInt(a.cantTotal.toString())||0,cant_retenida:parseInt(a.cantRetenida.toString())||0,estado:a.estado||"Aprobado",defecto:(a.defecto||"NINGUNO").toUpperCase(),reviso:a.reviso||"",responsable:(a.responsable||"").toUpperCase(),accion_correctiva:(a.accionCorrectiva||"").toUpperCase(),observacion_sugerida:(a.observacionSugerida||"").toUpperCase(),observacion:a.observacion||"NA",photo_url:a.photo});try{if(K){const a=s(n),{error:r}=await F.from("field_inspections").update(a).eq("id",K);if(r)throw r;m({type:"success",title:"REGISTRO ACTUALIZADO",message:`Inspección para OP #${n.op} actualizada correctamente.`}),W(null)}else{const a=n.planoOpc?Fe(n.planoOpc):[n.planoOpc],c=(a.length>0?a:[n.planoOpc]).map(b=>s({...n,planoOpc:b})),{error:p}=await F.from("field_inspections").insert(c);if(p)throw p;m({type:"success",title:"REGISTROS GUARDADOS",message:`${c.length} inspecciones generadas para OP #${n.op}.`}),n.estado==="Rechazado"&&(await Me(c[0]),m({type:"warning",title:"NC GENERADA",message:"Se ha abierto un borrador de No Conformidad automáticamente."}))}oe(),x(Ae),A("none")}catch(a){console.error(a),m({type:"error",title:"Error",message:"No se pudo guardar la inspección."})}},E="w-full p-3 bg-slate-50 dark:bg-[#0b0b14] border border-slate-200 dark:border-white/5 rounded-xl text-xs font-bold text-slate-900 dark:text-white focus:ring-2 focus:ring-[#5d5fef] outline-none transition-all uppercase placeholder:text-slate-400",y="text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-1.5 block ml-1";if(g)return e.jsxs("div",{className:"fixed inset-0 z-[3000] bg-slate-900 flex flex-col animate-fade-in",children:[e.jsxs("div",{className:"bg-white dark:bg-alco-surface p-4 flex items-center justify-between border-b dark:border-white/10 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"size-10 bg-sky-600 rounded-xl flex items-center justify-center text-white shadow-lg",children:e.jsx(pe,{})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-black text-slate-800 dark:text-white uppercase tracking-tight",children:g.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"size-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-widest",children:"Conexión Segura Suite Alco"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{const t=g.url;f(null),setTimeout(()=>f({...g,url:t}),10)},className:"p-3 bg-slate-100 dark:bg-white/5 text-slate-500 hover:text-sky-600 rounded-xl transition-all",title:"Recargar Formulario",children:e.jsx(q,{})}),e.jsxs("button",{onClick:()=>f(null),className:"px-6 py-2.5 bg-rose-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-xl shadow-rose-900/20 active:scale-95 transition-all flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-times"})," Finalizar y Salir"]})]})]}),e.jsx("div",{className:"flex-grow bg-slate-100 dark:bg-black/20 overflow-hidden",children:e.jsx("iframe",{src:g.url,className:"w-full h-full border-none",title:g.title,allow:"camera; microphone; geolocation"})}),e.jsx("div",{className:"bg-white dark:bg-alco-surface p-2 text-center border-t dark:border-white/5",children:e.jsxs("p",{className:"text-[9px] font-black text-slate-400 uppercase tracking-[0.5em]",children:["Sandbox Form Alco Suite © ",new Date().getFullYear()]})})]});const C=(t,s)=>{const a=c=>c.toLowerCase().replace(/[áàäâ]/g,"a").replace(/[éèëê]/g,"e").replace(/[íìïî]/g,"i").replace(/[óòöô]/g,"o").replace(/[úùüû]/g,"u").trim(),r=Object.keys(t);for(const c of s){const p=r.find(b=>a(b)===a(c));if(p)return t[p]}for(const c of s){const p=r.find(b=>a(b).includes(a(c)));if(p)return t[p]}},$e=t=>{if(!t)return new Date().toISOString().split("T")[0];if(typeof t=="number"){const a=new Date(Math.round((t-25569)*86400*1e3));return a.setMinutes(a.getMinutes()+a.getTimezoneOffset()),a.toISOString().split("T")[0]}const s=new Date(t);return isNaN(s.getTime())?new Date().toISOString().split("T")[0]:s.toISOString().split("T")[0]};return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(Ve,{crumbs:[{label:"Calidad",path:"/dashboard"},{label:"Formularios"}]}),e.jsx("h1",{className:"text-3xl font-black text-slate-800 dark:text-white mt-2 tracking-tight",children:"Gestión de Inspecciones"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(tt,{tableName:"field_inspections",onUploadComplete:oe,label:"Carga Masiva (Excel)",mapping:t=>({fecha:$e(C(t,["FECHA","DATE"])),area_proceso:String(C(t,["ÁREA DE PROCESO","AREA DE PROCESO","AREA"])||"").toUpperCase(),op:String(C(t,["OP","ORDEN"])||"").toUpperCase(),plano_opc:String(C(t,["PLANO (OPC)","PLANO","ITEM"])||"").toUpperCase(),diseno_referencia:String(C(t,["DISEÑO/REFERENCIA","DISEÑO","REFERENCIA"])||"").toUpperCase(),cant_total:parseInt(C(t,["CANT TOTAL","CANTIDAD","TOTAL"])||"0")||0,cant_retenida:parseInt(C(t,["CANT RETENIDA","RETENIDA","RECHAZADA"])||"0")||0,estado:C(t,["ESTADO","STATUS"])||"Aprobado",defecto:String(C(t,["DEFECTO","FALLA"])||"NINGUNO").toUpperCase(),reviso:String(C(t,["REVISÓ","REVISO","INSPECTOR"])||"").toUpperCase(),responsable:String(C(t,["RESPONSABLE","OPERARIO"])||"").toUpperCase(),accion_correctiva:String(C(t,["ACCION CORRECTIVA","ACCION"])||"").toUpperCase(),observacion:String(C(t,["OBSERVACION","HALLAZGO","OBSERVACIONES"])||"NA")}),columns:[{key:"fecha",label:"FECHA"},{key:"area_proceso",label:"ÁREA DE PROCESO"},{key:"op",label:"OP"},{key:"plano_opc",label:"PLANO (OPC)"},{key:"diseno_referencia",label:"DISEÑO/REFERENCIA"},{key:"cant_total",label:"CANT TOTAL"},{key:"cant_retenida",label:"CANT RETENIDA"},{key:"estado",label:"ESTADO"},{key:"defecto",label:"DEFECTO"},{key:"reviso",label:"REVISÓ"},{key:"responsable",label:"RESPONSABLE"},{key:"accion_correctiva",label:"ACCIÓN CORRECTIVA"},{key:"observacion",label:"OBSERVACIÓN"}]}),e.jsxs("button",{onClick:()=>I(!v),className:`flex items-center gap-2 px-4 py-2.5 ${v?"bg-slate-300 dark:bg-slate-600":"bg-[#4b5563] hover:bg-[#374151]"} text-white rounded-lg font-bold text-xs shadow-md transition-all`,children:[e.jsx(pe,{})," Enlaces Externos"]}),e.jsxs("button",{onClick:()=>A("general"),className:"flex items-center gap-2 px-4 py-2.5 bg-[#005c97] hover:bg-[#004a7a] text-white rounded-lg font-bold text-xs shadow-md transition-all",children:[e.jsx(Re,{})," Nueva Inspección"]})]})]}),v&&e.jsxs("div",{className:"bg-white dark:bg-alco-surface rounded-2xl shadow-sm border border-slate-100 dark:border-white/5 p-8 animate-fade-in-down mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tighter",children:"Formularios Externos Embebidos"})}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>O(!0),className:"px-4 py-2 bg-sky-600 text-white rounded-xl text-[10px] font-black uppercase tracking-widest shadow-lg shadow-sky-900/20 active:scale-95 transition-all",children:"+ Agregar Enlace"}),e.jsx("button",{onClick:()=>I(!1),className:"text-slate-400 hover:text-rose-500 font-black text-xs uppercase tracking-widest transition-colors",children:"Cerrar"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(t=>e.jsx("div",{className:"bg-white dark:bg-[#0b0b14] p-6 rounded-[2rem] border border-slate-100 dark:border-white/5 shadow-sm group hover:border-sky-500/50 transition-all relative overflow-hidden",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"size-12 rounded-2xl bg-sky-500/10 flex items-center justify-center text-sky-500 text-xl",children:e.jsx(pe,{})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-black text-slate-800 dark:text-white text-sm uppercase truncate tracking-tight mb-1",children:t.title}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase truncate opacity-60 mb-4",children:t.description}),e.jsxs("button",{onClick:()=>f(t),className:"inline-flex items-center gap-2 text-sky-600 font-black text-[9px] uppercase hover:underline",children:["Abrir en Suite ",e.jsx(ve,{className:"scale-75"})]})]}),e.jsx("button",{onClick:()=>ze(t.id,t.title),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 p-2 text-rose-500 transition-opacity",children:e.jsx(H,{className:"scale-75"})})]})},t.id))})]}),U==="general"&&e.jsxs("div",{className:"bg-white dark:bg-alco-surface p-4 md:p-10 rounded-3xl shadow-xl border border-slate-100 dark:border-white/5 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b dark:border-white/5 pb-6",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("h2",{className:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-tighter flex items-center gap-3",children:[e.jsx(Je,{className:"text-sky-600"})," Inspección Multimodal Alco"]}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest ml-9 opacity-60",children:"IA + Captura Semántica por Voz"})]}),e.jsx("button",{onClick:()=>A("none"),className:"text-slate-300 hover:text-rose-500 transition-colors text-3xl font-light",children:"×"})]}),e.jsx("form",{onSubmit:Ge,className:"space-y-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-10",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsx("label",{className:y,children:"Evidencia Visual"}),e.jsxs("div",{className:"aspect-square bg-slate-50 dark:bg-black/20 rounded-2xl border-2 border-dashed border-slate-200 dark:border-white/5 flex flex-col items-center justify-center relative overflow-hidden group",children:[n.photo?e.jsx("img",{src:n.photo,alt:"Evidencia",className:"w-full h-full object-cover"}):e.jsxs("div",{className:"text-center p-6 opacity-30",children:[e.jsx(ke,{className:"text-4xl mx-auto mb-3"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest",children:"Sin captura"})]}),e.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>m({type:"info",title:"Cámara",message:"Iniciando hardware de captura..."}),className:"p-4 bg-sky-600 text-white rounded-2xl shadow-xl hover:scale-110 transition-transform",children:e.jsx(ke,{})}),n.photo&&e.jsx("button",{type:"button",onClick:()=>x({...n,photo:""}),className:"p-4 bg-rose-600 text-white rounded-2xl shadow-xl hover:scale-110 transition-transform",children:e.jsx(H,{})})]})]}),e.jsxs("div",{className:"p-5 bg-sky-50 dark:bg-sky-900/10 rounded-2xl border border-sky-100 dark:border-sky-900/30",children:[e.jsxs("p",{className:"text-[9px] font-black text-sky-600 uppercase tracking-widest flex items-center gap-2 mb-2",children:[e.jsx(je,{className:"scale-75"})," Recomendación IA"]}),e.jsx("p",{className:"text-[11px] text-slate-600 dark:text-slate-400 leading-relaxed italic",children:'"Capture los bordes de la perfilería a 45° para detectar rebabas de corte automáticamente."'}),e.jsxs("button",{type:"button",onClick:_e,disabled:se,className:`w-full mt-3 py-2 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${se?"bg-slate-200 text-slate-400":"bg-gradient-to-r from-violet-600 to-indigo-600 text-white shadow-lg shadow-indigo-500/30 hover:scale-[1.02]"}`,children:[se?e.jsx(q,{className:"animate-spin"}):e.jsx(je,{}),se?"Procesando...":"Analizar con IA"]})]})]}),e.jsxs("div",{className:"lg:col-span-9 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:y,children:"1. FECHA:"}),e.jsx("input",{type:"date",name:"fecha",value:n.fecha,onChange:L,className:E})]}),e.jsx(Y,{label:"2. ÁREA DE PROCESO:",options:He,value:n.areaProceso,onChange:t=>x({...n,areaProceso:t})}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"3. ORDEN DE PRODUCCIÓN (OP):"}),e.jsx("input",{type:"text",name:"op",value:n.op,onChange:L,placeholder:"EJ: OP-24-100",className:E})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:y,children:"4. PLANO / ÍTEMS # (Rango: 1-10 o 1,3,5):"}),e.jsx("input",{type:"text",name:"planoOpc",value:n.planoOpc,onChange:L,placeholder:"EJ: 1-5, 8, 10",className:E})]}),e.jsx(Y,{label:"5. DISEÑO / SERIE:",options:Ye,value:n.disenoReferencia,onChange:t=>x({...n,disenoReferencia:t})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:y,children:"6. CANT. TOTAL:"}),e.jsx("input",{type:"number",name:"cantTotal",value:n.cantTotal,onChange:L,className:E})]}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"7. CANT. RETENIDA:"}),e.jsx("input",{type:"number",name:"cantRetenida",value:n.cantRetenida,onChange:L,className:E})]}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"8. ESTADO SGC:"}),e.jsx("select",{name:"estado",value:n.estado,onChange:L,required:!0,className:E,children:qe.map(t=>e.jsx("option",{children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"9. DEFECTO TÉCNICO:"}),e.jsx("select",{name:"defecto",value:n.defecto,onChange:L,className:E,children:Ke.map(t=>e.jsx("option",{children:t},t))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Y,{label:"10. REVISÓ (INSPECTOR):",options:Se,value:n.reviso,onChange:t=>x({...n,reviso:t})}),e.jsx(Y,{label:"11. RESPONSABLE (OPERARIO):",options:Qe,value:n.responsable,onChange:t=>x({...n,responsable:t})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:y,children:"12. ACCIÓN CORRECTIVA:"}),e.jsxs("select",{name:"accionCorrectiva",value:n.accionCorrectiva,onChange:L,className:E,children:[e.jsx("option",{value:"",children:"NINGUNA (VACÍO)"}),Xe.map(t=>e.jsx("option",{children:t},t))]})]}),e.jsx(Y,{label:"OBSERVACIÓN SUGERIDA:",options:Ze,value:n.observacionSugerida,onChange:t=>x({...n,observacionSugerida:t})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1.5 px-1",children:[e.jsx("label",{className:y,children:"13. OBSERVACIÓN (DICTAMEN FINAL)"}),e.jsx(at,{onTranscription:t=>x(s=>({...s,observacion:s.observacion?`${s.observacion} ${t}`:t})),className:"scale-75 origin-right"})]}),e.jsx("textarea",{name:"observacion",value:n.observacion,onChange:L,className:`${E} min-h-[120px] normal-case font-medium`,placeholder:"Relato técnico detallado del hallazgo detectado..."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>A("none"),className:"px-8 py-4 bg-slate-100 dark:bg-white/5 text-slate-500 rounded-2xl font-black text-[10px] uppercase tracking-widest",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:n.isLocked,className:`px-12 py-4 ${n.isLocked?"bg-slate-300 dark:bg-slate-700 cursor-not-allowed text-slate-500":"bg-[#005c97] text-white hover:scale-105 active:scale-95 shadow-xl shadow-sky-900/20"} rounded-2xl font-black text-[10px] uppercase tracking-widest transition-all flex items-center gap-3`,children:[n.isLocked?e.jsx("i",{className:"fas fa-lock"}):e.jsx(ye,{}),n.isLocked?"Bloqueado por Calidad":"Firmar y Guardar Registro"]})]})]})]})})]}),U==="none"&&e.jsxs("div",{className:"premium-card overflow-hidden animate-fade-in",children:[e.jsxs("div",{className:"p-8 bg-slate-50 dark:bg-white/5 border-b dark:border-white/5 flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-black uppercase tracking-tighter",children:"Historial Maestro de Inspecciones"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"md:hidden flex items-center gap-2 px-3 py-1.5 bg-white dark:bg-white/5 rounded-lg border dark:border-white/10",children:[e.jsx("input",{type:"checkbox",checked:R.length>0&&S.size===R.length,onChange:ge,className:"size-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-500",children:"Todo"})]}),S.size>0&&e.jsxs("button",{onClick:()=>ne(Array.from(S)),disabled:D,className:`px-4 py-2 ${D?"bg-slate-400":"bg-rose-600 shadow-lg shadow-rose-900/20"} text-white rounded-xl text-[10px] font-black uppercase tracking-widest active:scale-95 transition-all flex items-center gap-2`,children:[D?e.jsx(q,{className:"animate-spin scale-75"}):e.jsx(H,{className:"scale-75"}),D?"Borrando...":`Eliminar (${S.size})`]}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-white dark:bg-slate-800 rounded-xl shadow-inner border dark:border-white/5 flex-grow md:flex-initial",children:[e.jsx("input",{className:"bg-transparent border-none outline-none text-xs font-bold uppercase w-full md:w-48 placeholder:text-slate-400",placeholder:"BUSCAR...",value:J,onChange:t=>Te(t.target.value)}),e.jsx(Ie,{className:"text-slate-400 cursor-pointer hover:text-sky-600 transition-colors",onClick:()=>{}})]})]})]}),e.jsx("div",{className:"md:hidden p-4 space-y-4",children:D?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[e.jsx(q,{className:"animate-spin text-[#5d5fef]"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Consultando registros..."})]}):ae.length===0?e.jsx("div",{className:"text-center py-12 opacity-30 text-xs font-black uppercase tracking-[0.3em]",children:"No se encontraron resultados"}):ae.map(t=>e.jsxs("div",{className:"bg-slate-50 dark:bg-white/5 p-6 rounded-2xl border dark:border-white/5 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:S.has(t.id),onChange:()=>fe(t.id),className:"size-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),e.jsx("span",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:t.fecha})]}),e.jsx("span",{className:`px-2 py-0.5 rounded-md text-[8px] font-black uppercase border ${(t.estado||"").toUpperCase()==="APROBADO"?"bg-emerald-400 text-black border-emerald-500":(t.estado||"").toUpperCase()==="REPROCESAR"?"bg-red-600 text-white border-red-700":(t.estado||"").toUpperCase()==="RECHAZADO"?"bg-rose-100 text-rose-800 border-rose-200":"bg-amber-50 text-amber-700 border-amber-100"}`,children:t.estado})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-slate-800 dark:text-white uppercase text-sm tracking-tight",children:t.areaProceso}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 mt-1",children:[e.jsxs("p",{className:"text-[10px] text-sky-600 font-bold uppercase font-mono",children:["OP: ",t.op]}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-bold uppercase",children:["PLANO: ",t.planoOpc||"-"]})]}),e.jsx("p",{className:"text-[9px] text-slate-500 font-black uppercase mt-1 tracking-wider",children:t.disenoReferencia})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 py-2 border-y dark:border-white/5",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest block",children:"Total"}),e.jsx("span",{className:"text-xs font-bold",children:t.cantTotal})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest block",children:"Retenida"}),e.jsx("span",{className:"text-xs font-bold text-rose-600",children:t.cantRetenida})]})]}),e.jsxs("div",{className:"pt-2 flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8px] font-black text-slate-400 uppercase tracking-widest",children:"Responsable"}),e.jsx("span",{className:"text-[10px] font-bold uppercase",children:t.responsable||t.reviso})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>be(t),className:"p-3 bg-white dark:bg-white/5 text-slate-400 rounded-xl hover:text-sky-600 transition-all",children:e.jsx(Ce,{})}),e.jsx("button",{onClick:()=>ne(t.id),className:"p-3 bg-white dark:bg-white/5 text-slate-400 rounded-xl hover:text-rose-600 transition-all",children:e.jsx(H,{})})]})]})]},t.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto pb-4",children:e.jsxs("table",{className:"w-full min-w-[2000px] text-left border-collapse text-[10px] table-fixed",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"bg-[#3b82f6] text-white font-black tracking-wider border-b border-white/10",children:[e.jsxs("th",{style:{width:o.checkbox,minWidth:o.checkbox},className:"px-4 py-5 border-r border-white/10 text-center group cursor-pointer hover:bg-white/10 transition-colors relative",onClick:()=>w("fecha"),children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-0.5 h-full",children:[e.jsx("input",{type:"checkbox",checked:S.size>0&&S.size===R.length,onChange:t=>{t.stopPropagation(),ge()},className:"size-4 rounded border-white/20 bg-transparent text-sky-600 focus:ring-sky-500 mb-1 cursor-pointer"}),e.jsxs("div",{className:"flex flex-col -space-y-1",children:[e.jsx("span",{className:`text-[8px] leading-none ${i.key==="fecha"&&i.direction==="asc"?"text-white":"text-white/40"}`,children:"▲"}),e.jsx("span",{className:`text-[8px] leading-none ${i.key==="fecha"&&i.direction==="desc"?"text-white":"text-white/40"}`,children:"▼"})]})]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("checkbox",t)})]}),e.jsxs("th",{style:{width:o.fecha,minWidth:o.fecha},className:"px-6 py-5 border-r border-white/10 uppercase cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("fecha"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["Fecha ",i.key==="fecha"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("fecha",t)})]}),e.jsxs("th",{style:{width:o.areaProceso,minWidth:o.areaProceso},className:"px-6 py-5 border-r border-white/10 uppercase whitespace-nowrap cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("areaProceso"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["Área de Proceso ",i.key==="areaProceso"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("areaProceso",t)})]}),e.jsxs("th",{style:{width:o.op,minWidth:o.op},className:"px-6 py-5 border-r border-white/10 uppercase cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("op"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["OP ",i.key==="op"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("op",t)})]}),e.jsxs("th",{style:{width:o.planoOpc,minWidth:o.planoOpc},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("planoOpc"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["PLANO (OPC) ",i.key==="planoOpc"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("planoOpc",t)})]}),e.jsxs("th",{style:{width:o.disenoReferencia,minWidth:o.disenoReferencia},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("disenoReferencia"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["DISEÑO/REFERENCIA ",i.key==="disenoReferencia"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("disenoReferencia",t)})]}),e.jsxs("th",{style:{width:o.cantTotal,minWidth:o.cantTotal},className:"px-6 py-5 border-r border-white/10 text-center cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("cantTotal"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:["CANT TOTAL ",i.key==="cantTotal"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("cantTotal",t)})]}),e.jsxs("th",{style:{width:o.cantRetenida,minWidth:o.cantRetenida},className:"px-6 py-5 border-r border-white/10 text-center cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("cantRetenida"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-2",children:["CANT RETENIDA ",i.key==="cantRetenida"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("cantRetenida",t)})]}),e.jsxs("th",{style:{width:o.estado,minWidth:o.estado},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("estado"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["ESTADO ",i.key==="estado"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("estado",t)})]}),e.jsxs("th",{style:{width:o.defecto,minWidth:o.defecto},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("defecto"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["DEFECTO ",i.key==="defecto"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("defecto",t)})]}),e.jsxs("th",{style:{width:o.reviso,minWidth:o.reviso},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("reviso"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["REVISÓ ",i.key==="reviso"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("reviso",t)})]}),e.jsxs("th",{style:{width:o.responsable,minWidth:o.responsable},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("responsable"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["RESPONSABLE ",i.key==="responsable"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("responsable",t)})]}),e.jsxs("th",{style:{width:o.accionCorrectiva,minWidth:o.accionCorrectiva},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("accionCorrectiva"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["ACCION CORRECTIVA ",i.key==="accionCorrectiva"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("accionCorrectiva",t)})]}),e.jsxs("th",{style:{width:o.observacion,minWidth:o.observacion},className:"px-6 py-5 border-r border-white/10 cursor-pointer hover:bg-white/10 transition-colors group relative",onClick:()=>w("observacion"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:["OBSERVACION ",i.key==="observacion"&&(i.direction==="asc"?"↑":"↓")]}),e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("observacion",t)})]}),e.jsxs("th",{style:{width:o.actions,minWidth:o.actions},className:"px-6 py-5 text-center border-r border-white/10 relative",children:["ACCIONES",e.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-sky-400/50 z-10",onMouseDown:t=>N("actions",t)})]})]}),e.jsxs("tr",{className:"bg-white/5 border-b dark:border-white/10",children:[e.jsx("th",{className:"p-2 border-r dark:border-white/5"}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.fecha,onChange:t=>j({...d,fecha:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.areaProceso,onChange:t=>j({...d,areaProceso:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.op,onChange:t=>j({...d,op:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.planoOpc,onChange:t=>j({...d,planoOpc:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.disenoReferencia,onChange:t=>j({...d,disenoReferencia:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30 text-center",placeholder:"F...",value:d.cantTotal,onChange:t=>j({...d,cantTotal:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30 text-center",placeholder:"F...",value:d.cantRetenida,onChange:t=>j({...d,cantRetenida:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.estado,onChange:t=>j({...d,estado:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.defecto,onChange:t=>j({...d,defecto:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.reviso,onChange:t=>j({...d,reviso:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.responsable,onChange:t=>j({...d,responsable:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.accionCorrectiva,onChange:t=>j({...d,accionCorrectiva:t.target.value})})}),e.jsx("th",{className:"p-2 border-r dark:border-white/5",children:e.jsx("input",{className:"w-full bg-transparent text-[8px] uppercase font-bold outline-none placeholder:text-white/30",placeholder:"Filtrar...",value:d.observacion,onChange:t=>j({...d,observacion:t.target.value})})}),e.jsx("th",{className:"p-2 bg-white/5"})]})]}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-white/5",children:D?e.jsx("tr",{children:e.jsx("td",{colSpan:15,className:"px-8 py-24 text-center opacity-50",children:e.jsx("p",{className:"font-bold text-sm tracking-tight uppercase",children:"Cargando inspecciones..."})})}):ae.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:15,className:"px-8 py-24 text-center opacity-20",children:e.jsx("p",{className:"font-bold text-sm tracking-tight uppercase",children:"Sin resultados para los filtros actuales"})})}):ae.map(t=>e.jsxs("tr",{className:`hover:bg-slate-50 dark:hover:bg-white/5 transition-all text-[10px] font-bold ${S.has(t.id)?"bg-sky-50/50 dark:bg-sky-900/10":""}`,children:[e.jsx("td",{style:{width:o.checkbox},className:"px-4 py-4 text-center border-r dark:border-white/5 truncate",children:e.jsx("input",{type:"checkbox",checked:S.has(t.id),onChange:()=>fe(t.id),className:"size-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"})}),e.jsx("td",{style:{width:o.fecha},className:"px-6 py-4 border-r dark:border-white/5 font-bold text-black dark:text-white uppercase truncate",title:t.fecha,children:t.fecha}),e.jsx("td",{style:{width:o.areaProceso},className:"px-6 py-4 uppercase border-r dark:border-white/5 font-black text-black dark:text-white truncate",title:t.areaProceso,children:t.areaProceso}),e.jsx("td",{style:{width:o.op},className:"px-6 py-4 font-mono font-bold text-black dark:text-white uppercase border-r dark:border-white/5 truncate",title:t.op,children:t.op}),e.jsx("td",{style:{width:o.planoOpc},className:"px-6 py-4 text-black dark:text-white font-bold uppercase border-r dark:border-white/5 text-center truncate",title:t.planoOpc||"-",children:t.planoOpc||"-"}),e.jsx("td",{style:{width:o.disenoReferencia},className:"px-6 py-4 text-black dark:text-white font-black uppercase text-[9px] tracking-wider border-r dark:border-white/5 truncate",title:t.disenoReferencia,children:t.disenoReferencia}),e.jsx("td",{style:{width:o.cantTotal},className:"px-6 py-4 text-center font-bold text-black dark:text-white border-r dark:border-white/5 truncate",children:t.cantTotal}),e.jsx("td",{style:{width:o.cantRetenida},className:`px-6 py-4 text-center font-black border-r dark:border-white/5 truncate ${t.cantRetenida>0?"text-rose-600":"text-black dark:text-white"}`,children:t.cantRetenida}),e.jsx("td",{style:{width:o.estado},className:"px-6 py-4 text-center border-r dark:border-white/5 truncate",children:e.jsx("span",{className:`px-2 py-0.5 rounded-md text-[8px] font-black uppercase border ${(t.estado||"").toUpperCase()==="APROBADO"?"bg-emerald-400 text-black border-emerald-500":(t.estado||"").toUpperCase()==="REPROCESAR"?"bg-red-600 text-white border-red-700":(t.estado||"").toUpperCase()==="RECHAZADO"?"bg-rose-100 text-rose-800 border-rose-200":"bg-amber-50 text-amber-700 border-amber-100"}`,children:t.estado})}),e.jsx("td",{style:{width:o.defecto},className:`px-6 py-4 uppercase border-r dark:border-white/5 font-bold truncate ${["NINGUNO","NA"].includes((t.defecto||"").toUpperCase())?"text-black dark:text-white":"text-rose-600"}`,title:t.defecto,children:t.defecto}),e.jsx("td",{style:{width:o.reviso},className:"px-6 py-4 uppercase text-black dark:text-white font-bold border-r dark:border-white/5 truncate",title:t.reviso,children:t.reviso}),e.jsx("td",{style:{width:o.responsable},className:"px-6 py-4 uppercase text-black dark:text-white font-bold border-r dark:border-white/5 truncate",title:t.responsable,children:t.responsable}),e.jsx("td",{style:{width:o.accionCorrectiva},className:`px-6 py-4 border-r dark:border-white/5 font-bold truncate ${(t.accionCorrectiva||"").toUpperCase()==="INTERNA"?"text-amber-500":(t.accionCorrectiva||"").toUpperCase()==="REPOSICION"?"text-rose-600":["NA","NINGUNO","",null,void 0].includes(t.accionCorrectiva)||(t.accionCorrectiva||"").toUpperCase()==="NA"?"text-black dark:text-white font-normal":"text-amber-500"}`,title:t.accionCorrectiva,children:t.accionCorrectiva}),e.jsx("td",{style:{width:o.observacion},className:`px-6 py-4 uppercase text-[9px] border-r dark:border-white/5 truncate ${["NA","NINGUNA","NINGUNO",""].includes((t.observacion||"").toUpperCase())?"text-black dark:text-white":"text-rose-600 font-bold"}`,title:t.observacion,children:t.observacion}),e.jsx("td",{style:{width:o.actions},className:"px-4 py-4 text-center truncate",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>be(t),className:"p-2 text-slate-800 dark:text-white hover:text-sky-600 transition-colors",title:"Editar",children:e.jsx(Ce,{className:"scale-90"})}),e.jsx("button",{onClick:()=>ne(t.id),className:"p-2 text-slate-800 dark:text-white hover:text-rose-600 transition-colors",title:"Eliminar",children:e.jsx(H,{className:"scale-90"})})]})})]},t.id))})]})}),V>1&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 py-6 px-8 bg-slate-50 dark:bg-black/10 border-t dark:border-white/5",children:[e.jsxs("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest",children:["Mostrando ",Math.min(R.length,(k-1)*B+1)," - ",Math.min(R.length,k*B)," de ",R.length," registros"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ee(t=>Math.max(1,t-1)),disabled:k===1,className:`p-2 rounded-lg transition-all ${k===1?"text-slate-300 dark:text-slate-700 cursor-not-allowed":"text-sky-600 hover:bg-sky-50 dark:hover:bg-sky-900/20 active:scale-90"}`,children:e.jsx(et,{className:"scale-75"})}),e.jsx("div",{className:"flex items-center gap-1",children:[...Array(V)].map((t,s)=>{const a=s+1;return a===1||a===V||a>=k-1&&a<=k+1?e.jsx("button",{onClick:()=>ee(a),className:`size-8 rounded-lg text-[10px] font-black transition-all ${k===a?"bg-sky-600 text-white shadow-lg shadow-sky-900/20":"text-slate-400 hover:bg-slate-100 dark:hover:bg-white/5"}`,children:a},a):a===k-2||a===k+2?e.jsx("span",{className:"text-slate-300 dark:text-slate-700",children:"..."},a):null})}),e.jsx("button",{onClick:()=>ee(t=>Math.min(V,t+1)),disabled:k===V,className:`p-2 rounded-lg transition-all ${k===V?"text-slate-300 dark:text-slate-700 cursor-not-allowed":"text-sky-600 hover:bg-sky-50 dark:hover:bg-sky-900/20 active:scale-90"}`,children:e.jsx(ve,{className:"scale-75"})})]})]})]}),$&&e.jsx("div",{className:"fixed inset-0 z-[2500] bg-slate-900/90 backdrop-blur-md flex items-center justify-center p-6 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-[#0b0b14] rounded-3xl max-w-lg w-full p-12 shadow-2xl animate-fade-in-up border border-slate-200 dark:border-white/5 relative overflow-hidden my-auto",children:[e.jsxs("div",{className:"flex justify-between items-start mb-10",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-black text-slate-800 dark:text-white uppercase tracking-tighter leading-none",children:["Vincular ",e.jsx("span",{className:"text-sky-600",children:"Formulario"})]}),e.jsx("p",{className:"text-slate-500 font-bold uppercase text-[10px] tracking-widest mt-2",children:"Centralización de Datos Externos"})]}),e.jsx("button",{onClick:()=>O(!1),className:"text-slate-400 hover:text-rose-500 text-3xl transition-colors",children:"×"})]}),e.jsxs("form",{onSubmit:Ue,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:y,children:"Título del Enlace"}),e.jsx("input",{required:!0,name:"title",className:E,placeholder:"EJ: ENCUESTA SATISFACCIÓN"})]}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"URL del Formulario (Microsoft/Google Forms)"}),e.jsx("input",{required:!0,name:"url",type:"url",className:E,placeholder:"HTTPS://FORMS.OFFICE.COM/..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:y,children:"Breve Descripción"}),e.jsx("input",{required:!0,name:"description",className:E,placeholder:"PARA QUÉ SIRVE ESTE ENLACE..."})]}),e.jsxs("button",{type:"submit",className:"w-full py-5 bg-sky-600 text-white rounded-[2rem] font-black text-xs uppercase tracking-[0.2em] shadow-xl shadow-sky-600/20 active:scale-95 transition-all flex items-center justify-center gap-3",children:[e.jsx(ye,{})," Vincular Repositorio"]})]})]})})]})};export{dt as default};
