import{j as e}from"./vendor-ui-Csmkvd-_.js";import{r as i}from"./vendor-react-B11IQRCK.js";import{s as n}from"./insforgeClient-BTlHhBMi.js";import{a as j,a1 as w,Z as y,U as v,a2 as u,a3 as g,P as R,R as I,e as E,l as A}from"./index-K6Oge8P9.js";import{B as S}from"./Breadcrumbs-D1gceSdN.js";const x=[{id:"AREAS_PROCESO",label:"Áreas de Proceso",icon:w},{id:"DEFECTO_TYPES",label:"Tipos de Defecto",icon:y},{id:"OPERARIO_RESPONSABLES",label:"Operarios / Responsables",icon:v},{id:"REGISTRO_USERS",label:"Usuarios de Registro",icon:u}],G=()=>{const{addNotification:r}=j(),[l,f]=i.useState(x[0].id),[o,m]=i.useState([]),[b,p]=i.useState(!1),[d,h]=i.useState("");i.useEffect(()=>{c()},[l]);const c=async()=>{p(!0);try{const{data:a,error:s}=await n.from("master_data").select("*").eq("category",l).order("label",{ascending:!0});if(s)if(s.code==="42P01")m([]);else throw s;else m(a||[])}catch(a){r({type:"error",title:"ERROR DE CARGA",message:a.message})}finally{p(!1)}},k=async a=>{if(a.preventDefault(),!!d.trim())try{const s=d.trim().toUpperCase(),{error:t}=await n.from("master_data").insert([{category:l,label:s,value:s,is_active:!0}]);if(t)throw t;h(""),c(),r({type:"success",title:"REGISTRO GUARDADO",message:`"${s}" se ha añadido a la lista.`})}catch(s){r({type:"error",title:"ERROR AL GUARDAR",message:s.message})}},N=async(a,s)=>{if(confirm(`¿Desea eliminar permanentemente "${s}"?`))try{const{error:t}=await n.from("master_data").delete().eq("id",a);if(t)throw t;c(),r({type:"success",title:"REGISTRO ELIMINADO",message:"La entrada ha sido borrada."})}catch(t){r({type:"error",title:"ERROR AL ELIMINAR",message:t.message})}};return e.jsxs("div",{className:"animate-fade-in space-y-10 pb-20",children:[e.jsx(S,{crumbs:[{label:"Sistema",path:"/dashboard"},{label:"CONFIGURACIÓN"}]}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl md:text-5xl font-black text-slate-800 dark:text-white uppercase tracking-tighter leading-none",children:["Ajustes del ",e.jsx("span",{className:"text-sky-600",children:"Sistema"})]}),e.jsxs("p",{className:"text-slate-500 font-bold mt-2 uppercase text-[10px] md:text-xs tracking-widest flex items-center gap-2 italic",children:[e.jsx(u,{className:"text-sky-600"})," Gestión Centralizada de Datos Maestros y Tablas de Referencia"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8",children:[e.jsxs("div",{className:"lg:col-span-4 space-y-3",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.3em] mb-4 ml-2",children:"Directorios Maestros"}),x.map(a=>e.jsxs("button",{onClick:()=>f(a.id),className:`w-full p-5 rounded-2xl flex items-center gap-4 transition-all border ${l===a.id?"bg-sky-600 text-white border-sky-500 shadow-xl shadow-sky-600/20 scale-[1.02]":"bg-white dark:bg-alco-surface text-slate-600 dark:text-slate-400 border-slate-100 dark:border-white/5 hover:bg-slate-50 dark:hover:bg-white/5"}`,children:[e.jsx(a.icon,{className:l===a.id?"text-white":"text-sky-500"}),e.jsx("span",{className:"text-xs font-black uppercase tracking-tight",children:a.label})]},a.id)),e.jsxs("div",{className:"mt-10 p-6 bg-amber-50 dark:bg-amber-900/10 border border-amber-100 dark:border-amber-800/30 rounded-2xl space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-600 font-black text-[10px] uppercase tracking-widest",children:[e.jsx(g,{className:"scale-75"})," Nota Técnica"]}),e.jsx("p",{className:"text-[10px] text-amber-700/70 dark:text-amber-400/70 font-bold leading-relaxed",children:"Los cambios realizados aquí afectan globalmente a los menús de selección en los módulos de Inspección, No Conformidades y Metrología."})]})]}),e.jsxs("div",{className:"lg:col-span-8",children:[e.jsxs("div",{className:"bg-white dark:bg-alco-surface rounded-3xl border border-slate-100 dark:border-white/5 shadow-xl overflow-hidden animate-fade-in",children:[e.jsx("div",{className:"p-8 border-b dark:border-white/5 bg-slate-50/50 dark:bg-white/[0.02]",children:e.jsxs("form",{onSubmit:k,className:"flex gap-4",children:[e.jsx("div",{className:"flex-grow",children:e.jsx("input",{type:"text",className:"w-full p-4 bg-white dark:bg-[#1a1a24] border border-slate-200 dark:border-white/5 rounded-2xl text-xs font-bold text-slate-800 dark:text-white outline-none focus:ring-2 focus:ring-sky-500 uppercase transition-all",placeholder:`NUEVO ELEMENTO PARA ${x.find(a=>a.id===l)?.label}...`,value:d,onChange:a=>h(a.target.value)})}),e.jsxs("button",{type:"submit",className:"px-8 bg-sky-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-lg shadow-sky-600/20 active:scale-95 transition-all flex items-center gap-2",children:[e.jsx(R,{})," Añadir"]})]})}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto custom-scrollbar",children:b?e.jsxs("div",{className:"flex flex-col items-center justify-center p-20 space-y-4",children:[e.jsx(I,{className:"animate-spin text-sky-600 size-10"}),e.jsx("p",{className:"text-xs font-black uppercase tracking-widest text-slate-400",children:"Consultando Base de Datos..."})]}):o.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx(g,{className:"mx-auto text-4xl text-slate-200 dark:text-slate-800 mb-4"}),e.jsx("p",{className:"text-xs font-black uppercase text-slate-400 tracking-[0.2em]",children:"No se han encontrado registros"}),e.jsx("p",{className:"text-[10px] text-slate-300 font-bold uppercase mt-2",children:"La tabla `master_data` podría no estar inicializada."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:o.map(a=>e.jsxs("div",{className:"group p-4 bg-slate-50 dark:bg-white/[0.02] border border-slate-100 dark:border-white/5 rounded-2xl flex items-center justify-between hover:border-sky-500/50 transition-all",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 uppercase tracking-tight",children:a.label}),e.jsx("button",{onClick:()=>N(a.id,a.label),className:"p-2 text-slate-300 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-900/20 rounded-lg transition-all",children:e.jsx(E,{className:"scale-75"})})]},a.id))})}),e.jsxs("div",{className:"p-6 bg-slate-50 dark:bg-white/[0.02] border-t dark:border-white/5 text-right font-black text-[9px] text-slate-400 uppercase tracking-widest",children:["Total de registros: ",o.length]})]}),o.length===0&&!b&&e.jsxs("div",{className:"mt-8 p-8 border-2 border-dashed border-slate-200 dark:border-white/5 rounded-[2.5rem] text-center space-y-6",children:[e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase leading-relaxed",children:"Parece que no hay datos maestros cargados. Puede poblar la base de datos con los valores predeterminados de la App."}),e.jsxs("button",{onClick:async()=>{r({type:"info",title:"IMPORTACIÓN",message:"Iniciando carga de valores predeterminados..."})},className:"px-10 py-5 bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl text-[10px] font-black uppercase tracking-widest hover:bg-slate-50 transition-all",children:[e.jsx(A,{className:"inline mr-2"})," Poblar Datos Predeterminados"]})]})]})]})]})};export{G as default};
